"use strict";
/**
 * Mock Data Validation Tests
 * Ensures mock data conforms to the expected schema
 */
Object.defineProperty(exports, "__esModule", { value: true });
const mocks_1 = require("./mocks");
describe('Mock Students Data', () => {
    test('should have exactly 10 student records', () => {
        expect(mocks_1.mockStudents).toHaveLength(10);
    });
    test('all students should have required fields', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(student).toHaveProperty('student_id');
            expect(student).toHaveProperty('name_1');
            expect(student).toHaveProperty('name_2');
            expect(student).toHaveProperty('marks');
            expect(student).toHaveProperty('class');
            expect(student).toHaveProperty('class_no');
            expect(student).toHaveProperty('last_login');
            expect(student).toHaveProperty('last_update');
            expect(student).toHaveProperty('teacher_id');
            expect(student).toHaveProperty('password');
        });
    });
    test('student IDs should follow STU### pattern', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(student.student_id).toMatch(/^STU\d{3}$/);
        });
    });
    test('student IDs should be unique', () => {
        const ids = mocks_1.mockStudents.map((s) => s.student_id);
        const uniqueIds = new Set(ids);
        expect(uniqueIds.size).toBe(mocks_1.mockStudents.length);
    });
    test('marks should be between 0 and 1000', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(student.marks).toBeGreaterThanOrEqual(0);
            expect(student.marks).toBeLessThanOrEqual(1000);
        });
    });
    test('class should be valid format (e.g., 1A, 2B)', () => {
        const validClasses = ['1A', '1B', '2A', '2B'];
        mocks_1.mockStudents.forEach((student) => {
            expect(validClasses).toContain(student.class);
        });
    });
    test('class_no should be two-digit format', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(student.class_no).toMatch(/^\d{2}$/);
        });
    });
    test('teacher_id should follow TCH### pattern', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(student.teacher_id).toMatch(/^TCH\d{3}$/);
        });
    });
    test('last_login and last_update should be valid ISO date strings', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(new Date(student.last_login).toISOString()).toBe(student.last_login);
            expect(new Date(student.last_update).toISOString()).toBe(student.last_update);
        });
    });
    test('passwords should be properly hashed', () => {
        mocks_1.mockStudents.forEach((student) => {
            expect(student.password).toHaveLength(64); // SHA-256 produces 64 hex characters
            expect(student.password).toBe(mocks_1.MOCK_STUDENT_PASSWORD_HASH);
        });
    });
});
describe('Mock Teachers Data', () => {
    test('should have exactly 3 teacher records', () => {
        expect(mocks_1.mockTeachers).toHaveLength(3);
    });
    test('all teachers should have required fields', () => {
        mocks_1.mockTeachers.forEach((teacher) => {
            expect(teacher).toHaveProperty('teacher_id');
            expect(teacher).toHaveProperty('password');
            expect(teacher).toHaveProperty('responsible_class');
            expect(teacher).toHaveProperty('last_login');
            expect(teacher).toHaveProperty('is_admin');
        });
    });
    test('teacher IDs should follow TCH### pattern', () => {
        mocks_1.mockTeachers.forEach((teacher) => {
            expect(teacher.teacher_id).toMatch(/^TCH\d{3}$/);
        });
    });
    test('teacher IDs should be unique', () => {
        const ids = mocks_1.mockTeachers.map((t) => t.teacher_id);
        const uniqueIds = new Set(ids);
        expect(uniqueIds.size).toBe(mocks_1.mockTeachers.length);
    });
    test('responsible_class should be an array', () => {
        mocks_1.mockTeachers.forEach((teacher) => {
            expect(Array.isArray(teacher.responsible_class)).toBe(true);
            expect(teacher.responsible_class.length).toBeGreaterThan(0);
        });
    });
    test('is_admin should be a boolean', () => {
        mocks_1.mockTeachers.forEach((teacher) => {
            expect(typeof teacher.is_admin).toBe('boolean');
        });
    });
    test('at least one teacher should be an admin', () => {
        const adminTeachers = mocks_1.mockTeachers.filter((t) => t.is_admin);
        expect(adminTeachers.length).toBeGreaterThan(0);
    });
    test('last_login should be valid ISO date string', () => {
        mocks_1.mockTeachers.forEach((teacher) => {
            expect(new Date(teacher.last_login).toISOString()).toBe(teacher.last_login);
        });
    });
    test('passwords should be properly hashed', () => {
        mocks_1.mockTeachers.forEach((teacher) => {
            expect(teacher.password).toHaveLength(64); // SHA-256 produces 64 hex characters
            // Check if password is either teacher or admin hash
            const validHashes = [mocks_1.MOCK_TEACHER_PASSWORD_HASH, mocks_1.MOCK_ADMIN_PASSWORD_HASH];
            expect(validHashes).toContain(teacher.password);
        });
    });
});
describe('Mock Games Data', () => {
    test('should have exactly 20 game records', () => {
        expect(mocks_1.mockGames).toHaveLength(20);
    });
    test('all games should have required fields', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game).toHaveProperty('game_id');
            expect(game).toHaveProperty('game_name');
            expect(game).toHaveProperty('student_id');
            expect(game).toHaveProperty('subject');
            expect(game).toHaveProperty('difficulty');
            expect(game).toHaveProperty('teacher_id');
            expect(game).toHaveProperty('last_update');
            expect(game).toHaveProperty('scratch_id');
            expect(game).toHaveProperty('scratch_api');
            expect(game).toHaveProperty('accumulated_click');
        });
    });
    test('game IDs should follow GAME### pattern', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game.game_id).toMatch(/^GAME\d{3}$/);
        });
    });
    test('game IDs should be unique', () => {
        const ids = mocks_1.mockGames.map((g) => g.game_id);
        const uniqueIds = new Set(ids);
        expect(uniqueIds.size).toBe(mocks_1.mockGames.length);
    });
    test('subject should be one of the valid values', () => {
        const validSubjects = [
            'Chinese Language',
            'English Language',
            'Mathematics',
            'Humanities and Science',
        ];
        mocks_1.mockGames.forEach((game) => {
            expect(validSubjects).toContain(game.subject);
        });
    });
    test('difficulty should be one of the valid values', () => {
        const validDifficulties = ['Beginner', 'Intermediate', 'Advanced'];
        mocks_1.mockGames.forEach((game) => {
            expect(validDifficulties).toContain(game.difficulty);
        });
    });
    test('student_id should follow STU### pattern', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game.student_id).toMatch(/^STU\d{3}$/);
        });
    });
    test('teacher_id should follow TCH### pattern', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game.teacher_id).toMatch(/^TCH\d{3}$/);
        });
    });
    test('accumulated_click should be non-negative', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game.accumulated_click).toBeGreaterThanOrEqual(0);
        });
    });
    test('scratch_id should be numeric string', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game.scratch_id).toMatch(/^\d+$/);
        });
    });
    test('scratch_api should be valid Scratch API URL', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(game.scratch_api).toMatch(/^https:\/\/api\.scratch\.mit\.edu\/projects\/\d+$/);
        });
    });
    test('last_update should be valid ISO date string', () => {
        mocks_1.mockGames.forEach((game) => {
            expect(new Date(game.last_update).toISOString()).toBe(game.last_update);
        });
    });
    test('all subjects should be represented', () => {
        const subjects = mocks_1.mockGames.map((g) => g.subject);
        expect(subjects).toContain('Chinese Language');
        expect(subjects).toContain('English Language');
        expect(subjects).toContain('Mathematics');
        expect(subjects).toContain('Humanities and Science');
    });
    test('all difficulty levels should be represented', () => {
        const difficulties = mocks_1.mockGames.map((g) => g.difficulty);
        expect(difficulties).toContain('Beginner');
        expect(difficulties).toContain('Intermediate');
        expect(difficulties).toContain('Advanced');
    });
});
describe('Mock Data Relationships', () => {
    test('all student_ids in games should exist in students', () => {
        const studentIds = mocks_1.mockStudents.map((s) => s.student_id);
        mocks_1.mockGames.forEach((game) => {
            expect(studentIds).toContain(game.student_id);
        });
    });
    test('all teacher_ids in students should exist in teachers', () => {
        const teacherIds = mocks_1.mockTeachers.map((t) => t.teacher_id);
        mocks_1.mockStudents.forEach((student) => {
            expect(teacherIds).toContain(student.teacher_id);
        });
    });
    test('all teacher_ids in games should exist in teachers', () => {
        const teacherIds = mocks_1.mockTeachers.map((t) => t.teacher_id);
        mocks_1.mockGames.forEach((game) => {
            expect(teacherIds).toContain(game.teacher_id);
        });
    });
    test('each student should have at least one game', () => {
        mocks_1.mockStudents.forEach((student) => {
            const studentGames = mocks_1.mockGames.filter((g) => g.student_id === student.student_id);
            expect(studentGames.length).toBeGreaterThan(0);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9ja3MudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1vY2tzLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFFSCxtQ0FPaUI7QUFFakIsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtJQUNsQyxJQUFJLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1FBQ2xELE1BQU0sQ0FBQyxvQkFBWSxDQUFDLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtRQUNwRCxvQkFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQVksRUFBRSxFQUFFO1lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN4QyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FB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QyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1FBQ3RELG9CQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBWSxFQUFFLEVBQUU7WUFDcEMsTUFBTSxZQUFZLEdBQUcsaUJBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLEtBQUssT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3ZGLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTW9jayBEYXRhIFZhbGlkYXRpb24gVGVzdHNcbiAqIEVuc3VyZXMgbW9jayBkYXRhIGNvbmZvcm1zIHRvIHRoZSBleHBlY3RlZCBzY2hlbWFcbiAqL1xuXG5pbXBvcnQge1xuICBtb2NrU3R1ZGVudHMsXG4gIG1vY2tUZWFjaGVycyxcbiAgbW9ja0dhbWVzLFxuICBNT0NLX1NUVURFTlRfUEFTU1dPUkRfSEFTSCxcbiAgTU9DS19URUFDSEVSX1BBU1NXT1JEX0hBU0gsXG4gIE1PQ0tfQURNSU5fUEFTU1dPUkRfSEFTSCxcbn0gZnJvbSAnLi9tb2Nrcyc7XG5cbmRlc2NyaWJlKCdNb2NrIFN0dWRlbnRzIERhdGEnLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBoYXZlIGV4YWN0bHkgMTAgc3R1ZGVudCByZWNvcmRzJywgKCkgPT4ge1xuICAgIGV4cGVjdChtb2NrU3R1ZGVudHMpLnRvSGF2ZUxlbmd0aCgxMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FsbCBzdHVkZW50cyBzaG91bGQgaGF2ZSByZXF1aXJlZCBmaWVsZHMnLCAoKSA9PiB7XG4gICAgbW9ja1N0dWRlbnRzLmZvckVhY2goKHN0dWRlbnQ6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHN0dWRlbnQpLnRvSGF2ZVByb3BlcnR5KCdzdHVkZW50X2lkJyk7XG4gICAgICBleHBlY3Qoc3R1ZGVudCkudG9IYXZlUHJvcGVydHkoJ25hbWVfMScpO1xuICAgICAgZXhwZWN0KHN0dWRlbnQpLnRvSGF2ZVByb3BlcnR5KCduYW1lXzInKTtcbiAgICAgIGV4cGVjdChzdHVkZW50KS50b0hhdmVQcm9wZXJ0eSgnbWFya3MnKTtcbiAgICAgIGV4cGVjdChzdHVkZW50KS50b0hhdmVQcm9wZXJ0eSgnY2xhc3MnKTtcbiAgICAgIGV4cGVjdChzdHVkZW50KS50b0hhdmVQcm9wZXJ0eSgnY2xhc3Nfbm8nKTtcbiAgICAgIGV4cGVjdChzdHVkZW50KS50b0hhdmVQcm9wZXJ0eSgnbGFzdF9sb2dpbicpO1xuICAgICAgZXhwZWN0KHN0dWRlbnQpLnRvSGF2ZVByb3BlcnR5KCdsYXN0X3VwZGF0ZScpO1xuICAgICAgZXhwZWN0KHN0dWRlbnQpLnRvSGF2ZVByb3BlcnR5KCd0ZWFjaGVyX2lkJyk7XG4gICAgICBleHBlY3Qoc3R1ZGVudCkudG9IYXZlUHJvcGVydHkoJ3Bhc3N3b3JkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3N0dWRlbnQgSURzIHNob3VsZCBmb2xsb3cgU1RVIyMjIHBhdHRlcm4nLCAoKSA9PiB7XG4gICAgbW9ja1N0dWRlbnRzLmZvckVhY2goKHN0dWRlbnQ6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHN0dWRlbnQuc3R1ZGVudF9pZCkudG9NYXRjaCgvXlNUVVxcZHszfSQvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnc3R1ZGVudCBJRHMgc2hvdWxkIGJlIHVuaXF1ZScsICgpID0+IHtcbiAgICBjb25zdCBpZHMgPSBtb2NrU3R1ZGVudHMubWFwKChzOiBhbnkpID0+IHMuc3R1ZGVudF9pZCk7XG4gICAgY29uc3QgdW5pcXVlSWRzID0gbmV3IFNldChpZHMpO1xuICAgIGV4cGVjdCh1bmlxdWVJZHMuc2l6ZSkudG9CZShtb2NrU3R1ZGVudHMubGVuZ3RoKTtcbiAgfSk7XG5cbiAgdGVzdCgnbWFya3Mgc2hvdWxkIGJlIGJldHdlZW4gMCBhbmQgMTAwMCcsICgpID0+IHtcbiAgICBtb2NrU3R1ZGVudHMuZm9yRWFjaCgoc3R1ZGVudDogYW55KSA9PiB7XG4gICAgICBleHBlY3Qoc3R1ZGVudC5tYXJrcykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICAgIGV4cGVjdChzdHVkZW50Lm1hcmtzKS50b0JlTGVzc1RoYW5PckVxdWFsKDEwMDApO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjbGFzcyBzaG91bGQgYmUgdmFsaWQgZm9ybWF0IChlLmcuLCAxQSwgMkIpJywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkQ2xhc3NlcyA9IFsnMUEnLCAnMUInLCAnMkEnLCAnMkInXTtcbiAgICBtb2NrU3R1ZGVudHMuZm9yRWFjaCgoc3R1ZGVudDogYW55KSA9PiB7XG4gICAgICBleHBlY3QodmFsaWRDbGFzc2VzKS50b0NvbnRhaW4oc3R1ZGVudC5jbGFzcyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NsYXNzX25vIHNob3VsZCBiZSB0d28tZGlnaXQgZm9ybWF0JywgKCkgPT4ge1xuICAgIG1vY2tTdHVkZW50cy5mb3JFYWNoKChzdHVkZW50OiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdChzdHVkZW50LmNsYXNzX25vKS50b01hdGNoKC9eXFxkezJ9JC8pO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCd0ZWFjaGVyX2lkIHNob3VsZCBmb2xsb3cgVENIIyMjIHBhdHRlcm4nLCAoKSA9PiB7XG4gICAgbW9ja1N0dWRlbnRzLmZvckVhY2goKHN0dWRlbnQ6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHN0dWRlbnQudGVhY2hlcl9pZCkudG9NYXRjaCgvXlRDSFxcZHszfSQvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnbGFzdF9sb2dpbiBhbmQgbGFzdF91cGRhdGUgc2hvdWxkIGJlIHZhbGlkIElTTyBkYXRlIHN0cmluZ3MnLCAoKSA9PiB7XG4gICAgbW9ja1N0dWRlbnRzLmZvckVhY2goKHN0dWRlbnQ6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KG5ldyBEYXRlKHN0dWRlbnQubGFzdF9sb2dpbikudG9JU09TdHJpbmcoKSkudG9CZShzdHVkZW50Lmxhc3RfbG9naW4pO1xuICAgICAgZXhwZWN0KG5ldyBEYXRlKHN0dWRlbnQubGFzdF91cGRhdGUpLnRvSVNPU3RyaW5nKCkpLnRvQmUoc3R1ZGVudC5sYXN0X3VwZGF0ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Bhc3N3b3JkcyBzaG91bGQgYmUgcHJvcGVybHkgaGFzaGVkJywgKCkgPT4ge1xuICAgIG1vY2tTdHVkZW50cy5mb3JFYWNoKChzdHVkZW50OiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdChzdHVkZW50LnBhc3N3b3JkKS50b0hhdmVMZW5ndGgoNjQpOyAvLyBTSEEtMjU2IHByb2R1Y2VzIDY0IGhleCBjaGFyYWN0ZXJzXG4gICAgICBleHBlY3Qoc3R1ZGVudC5wYXNzd29yZCkudG9CZShNT0NLX1NUVURFTlRfUEFTU1dPUkRfSEFTSCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdNb2NrIFRlYWNoZXJzIERhdGEnLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBoYXZlIGV4YWN0bHkgMyB0ZWFjaGVyIHJlY29yZHMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KG1vY2tUZWFjaGVycykudG9IYXZlTGVuZ3RoKDMpO1xuICB9KTtcblxuICB0ZXN0KCdhbGwgdGVhY2hlcnMgc2hvdWxkIGhhdmUgcmVxdWlyZWQgZmllbGRzJywgKCkgPT4ge1xuICAgIG1vY2tUZWFjaGVycy5mb3JFYWNoKCh0ZWFjaGVyOiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdCh0ZWFjaGVyKS50b0hhdmVQcm9wZXJ0eSgndGVhY2hlcl9pZCcpO1xuICAgICAgZXhwZWN0KHRlYWNoZXIpLnRvSGF2ZVByb3BlcnR5KCdwYXNzd29yZCcpO1xuICAgICAgZXhwZWN0KHRlYWNoZXIpLnRvSGF2ZVByb3BlcnR5KCdyZXNwb25zaWJsZV9jbGFzcycpO1xuICAgICAgZXhwZWN0KHRlYWNoZXIpLnRvSGF2ZVByb3BlcnR5KCdsYXN0X2xvZ2luJyk7XG4gICAgICBleHBlY3QodGVhY2hlcikudG9IYXZlUHJvcGVydHkoJ2lzX2FkbWluJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3RlYWNoZXIgSURzIHNob3VsZCBmb2xsb3cgVENIIyMjIHBhdHRlcm4nLCAoKSA9PiB7XG4gICAgbW9ja1RlYWNoZXJzLmZvckVhY2goKHRlYWNoZXI6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHRlYWNoZXIudGVhY2hlcl9pZCkudG9NYXRjaCgvXlRDSFxcZHszfSQvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgndGVhY2hlciBJRHMgc2hvdWxkIGJlIHVuaXF1ZScsICgpID0+IHtcbiAgICBjb25zdCBpZHMgPSBtb2NrVGVhY2hlcnMubWFwKCh0OiBhbnkpID0+IHQudGVhY2hlcl9pZCk7XG4gICAgY29uc3QgdW5pcXVlSWRzID0gbmV3IFNldChpZHMpO1xuICAgIGV4cGVjdCh1bmlxdWVJZHMuc2l6ZSkudG9CZShtb2NrVGVhY2hlcnMubGVuZ3RoKTtcbiAgfSk7XG5cbiAgdGVzdCgncmVzcG9uc2libGVfY2xhc3Mgc2hvdWxkIGJlIGFuIGFycmF5JywgKCkgPT4ge1xuICAgIG1vY2tUZWFjaGVycy5mb3JFYWNoKCh0ZWFjaGVyOiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHRlYWNoZXIucmVzcG9uc2libGVfY2xhc3MpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHRlYWNoZXIucmVzcG9uc2libGVfY2xhc3MubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2lzX2FkbWluIHNob3VsZCBiZSBhIGJvb2xlYW4nLCAoKSA9PiB7XG4gICAgbW9ja1RlYWNoZXJzLmZvckVhY2goKHRlYWNoZXI6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHR5cGVvZiB0ZWFjaGVyLmlzX2FkbWluKS50b0JlKCdib29sZWFuJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2F0IGxlYXN0IG9uZSB0ZWFjaGVyIHNob3VsZCBiZSBhbiBhZG1pbicsICgpID0+IHtcbiAgICBjb25zdCBhZG1pblRlYWNoZXJzID0gbW9ja1RlYWNoZXJzLmZpbHRlcigodDogYW55KSA9PiB0LmlzX2FkbWluKTtcbiAgICBleHBlY3QoYWRtaW5UZWFjaGVycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgfSk7XG5cbiAgdGVzdCgnbGFzdF9sb2dpbiBzaG91bGQgYmUgdmFsaWQgSVNPIGRhdGUgc3RyaW5nJywgKCkgPT4ge1xuICAgIG1vY2tUZWFjaGVycy5mb3JFYWNoKCh0ZWFjaGVyOiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdChuZXcgRGF0ZSh0ZWFjaGVyLmxhc3RfbG9naW4pLnRvSVNPU3RyaW5nKCkpLnRvQmUodGVhY2hlci5sYXN0X2xvZ2luKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgncGFzc3dvcmRzIHNob3VsZCBiZSBwcm9wZXJseSBoYXNoZWQnLCAoKSA9PiB7XG4gICAgbW9ja1RlYWNoZXJzLmZvckVhY2goKHRlYWNoZXI6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHRlYWNoZXIucGFzc3dvcmQpLnRvSGF2ZUxlbmd0aCg2NCk7IC8vIFNIQS0yNTYgcHJvZHVjZXMgNjQgaGV4IGNoYXJhY3RlcnNcbiAgICAgIC8vIENoZWNrIGlmIHBhc3N3b3JkIGlzIGVpdGhlciB0ZWFjaGVyIG9yIGFkbWluIGhhc2hcbiAgICAgIGNvbnN0IHZhbGlkSGFzaGVzID0gW01PQ0tfVEVBQ0hFUl9QQVNTV09SRF9IQVNILCBNT0NLX0FETUlOX1BBU1NXT1JEX0hBU0hdO1xuICAgICAgZXhwZWN0KHZhbGlkSGFzaGVzKS50b0NvbnRhaW4odGVhY2hlci5wYXNzd29yZCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdNb2NrIEdhbWVzIERhdGEnLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBoYXZlIGV4YWN0bHkgMjAgZ2FtZSByZWNvcmRzJywgKCkgPT4ge1xuICAgIGV4cGVjdChtb2NrR2FtZXMpLnRvSGF2ZUxlbmd0aCgyMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FsbCBnYW1lcyBzaG91bGQgaGF2ZSByZXF1aXJlZCBmaWVsZHMnLCAoKSA9PiB7XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KGdhbWUpLnRvSGF2ZVByb3BlcnR5KCdnYW1lX2lkJyk7XG4gICAgICBleHBlY3QoZ2FtZSkudG9IYXZlUHJvcGVydHkoJ2dhbWVfbmFtZScpO1xuICAgICAgZXhwZWN0KGdhbWUpLnRvSGF2ZVByb3BlcnR5KCdzdHVkZW50X2lkJyk7XG4gICAgICBleHBlY3QoZ2FtZSkudG9IYXZlUHJvcGVydHkoJ3N1YmplY3QnKTtcbiAgICAgIGV4cGVjdChnYW1lKS50b0hhdmVQcm9wZXJ0eSgnZGlmZmljdWx0eScpO1xuICAgICAgZXhwZWN0KGdhbWUpLnRvSGF2ZVByb3BlcnR5KCd0ZWFjaGVyX2lkJyk7XG4gICAgICBleHBlY3QoZ2FtZSkudG9IYXZlUHJvcGVydHkoJ2xhc3RfdXBkYXRlJyk7XG4gICAgICBleHBlY3QoZ2FtZSkudG9IYXZlUHJvcGVydHkoJ3NjcmF0Y2hfaWQnKTtcbiAgICAgIGV4cGVjdChnYW1lKS50b0hhdmVQcm9wZXJ0eSgnc2NyYXRjaF9hcGknKTtcbiAgICAgIGV4cGVjdChnYW1lKS50b0hhdmVQcm9wZXJ0eSgnYWNjdW11bGF0ZWRfY2xpY2snKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2FtZSBJRHMgc2hvdWxkIGZvbGxvdyBHQU1FIyMjIHBhdHRlcm4nLCAoKSA9PiB7XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KGdhbWUuZ2FtZV9pZCkudG9NYXRjaCgvXkdBTUVcXGR7M30kLyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2dhbWUgSURzIHNob3VsZCBiZSB1bmlxdWUnLCAoKSA9PiB7XG4gICAgY29uc3QgaWRzID0gbW9ja0dhbWVzLm1hcCgoZzogYW55KSA9PiBnLmdhbWVfaWQpO1xuICAgIGNvbnN0IHVuaXF1ZUlkcyA9IG5ldyBTZXQoaWRzKTtcbiAgICBleHBlY3QodW5pcXVlSWRzLnNpemUpLnRvQmUobW9ja0dhbWVzLmxlbmd0aCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3N1YmplY3Qgc2hvdWxkIGJlIG9uZSBvZiB0aGUgdmFsaWQgdmFsdWVzJywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkU3ViamVjdHMgPSBbXG4gICAgICAnQ2hpbmVzZSBMYW5ndWFnZScsXG4gICAgICAnRW5nbGlzaCBMYW5ndWFnZScsXG4gICAgICAnTWF0aGVtYXRpY3MnLFxuICAgICAgJ0h1bWFuaXRpZXMgYW5kIFNjaWVuY2UnLFxuICAgIF07XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkU3ViamVjdHMpLnRvQ29udGFpbihnYW1lLnN1YmplY3QpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdkaWZmaWN1bHR5IHNob3VsZCBiZSBvbmUgb2YgdGhlIHZhbGlkIHZhbHVlcycsICgpID0+IHtcbiAgICBjb25zdCB2YWxpZERpZmZpY3VsdGllcyA9IFsnQmVnaW5uZXInLCAnSW50ZXJtZWRpYXRlJywgJ0FkdmFuY2VkJ107XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkRGlmZmljdWx0aWVzKS50b0NvbnRhaW4oZ2FtZS5kaWZmaWN1bHR5KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnc3R1ZGVudF9pZCBzaG91bGQgZm9sbG93IFNUVSMjIyBwYXR0ZXJuJywgKCkgPT4ge1xuICAgIG1vY2tHYW1lcy5mb3JFYWNoKChnYW1lOiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdChnYW1lLnN0dWRlbnRfaWQpLnRvTWF0Y2goL15TVFVcXGR7M30kLyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3RlYWNoZXJfaWQgc2hvdWxkIGZvbGxvdyBUQ0gjIyMgcGF0dGVybicsICgpID0+IHtcbiAgICBtb2NrR2FtZXMuZm9yRWFjaCgoZ2FtZTogYW55KSA9PiB7XG4gICAgICBleHBlY3QoZ2FtZS50ZWFjaGVyX2lkKS50b01hdGNoKC9eVENIXFxkezN9JC8pO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdhY2N1bXVsYXRlZF9jbGljayBzaG91bGQgYmUgbm9uLW5lZ2F0aXZlJywgKCkgPT4ge1xuICAgIG1vY2tHYW1lcy5mb3JFYWNoKChnYW1lOiBhbnkpID0+IHtcbiAgICAgIGV4cGVjdChnYW1lLmFjY3VtdWxhdGVkX2NsaWNrKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdzY3JhdGNoX2lkIHNob3VsZCBiZSBudW1lcmljIHN0cmluZycsICgpID0+IHtcbiAgICBtb2NrR2FtZXMuZm9yRWFjaCgoZ2FtZTogYW55KSA9PiB7XG4gICAgICBleHBlY3QoZ2FtZS5zY3JhdGNoX2lkKS50b01hdGNoKC9eXFxkKyQvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnc2NyYXRjaF9hcGkgc2hvdWxkIGJlIHZhbGlkIFNjcmF0Y2ggQVBJIFVSTCcsICgpID0+IHtcbiAgICBtb2NrR2FtZXMuZm9yRWFjaCgoZ2FtZTogYW55KSA9PiB7XG4gICAgICBleHBlY3QoZ2FtZS5zY3JhdGNoX2FwaSkudG9NYXRjaCgvXmh0dHBzOlxcL1xcL2FwaVxcLnNjcmF0Y2hcXC5taXRcXC5lZHVcXC9wcm9qZWN0c1xcL1xcZCskLyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2xhc3RfdXBkYXRlIHNob3VsZCBiZSB2YWxpZCBJU08gZGF0ZSBzdHJpbmcnLCAoKSA9PiB7XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KG5ldyBEYXRlKGdhbWUubGFzdF91cGRhdGUpLnRvSVNPU3RyaW5nKCkpLnRvQmUoZ2FtZS5sYXN0X3VwZGF0ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FsbCBzdWJqZWN0cyBzaG91bGQgYmUgcmVwcmVzZW50ZWQnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3ViamVjdHMgPSBtb2NrR2FtZXMubWFwKChnOiBhbnkpID0+IGcuc3ViamVjdCk7XG4gICAgZXhwZWN0KHN1YmplY3RzKS50b0NvbnRhaW4oJ0NoaW5lc2UgTGFuZ3VhZ2UnKTtcbiAgICBleHBlY3Qoc3ViamVjdHMpLnRvQ29udGFpbignRW5nbGlzaCBMYW5ndWFnZScpO1xuICAgIGV4cGVjdChzdWJqZWN0cykudG9Db250YWluKCdNYXRoZW1hdGljcycpO1xuICAgIGV4cGVjdChzdWJqZWN0cykudG9Db250YWluKCdIdW1hbml0aWVzIGFuZCBTY2llbmNlJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FsbCBkaWZmaWN1bHR5IGxldmVscyBzaG91bGQgYmUgcmVwcmVzZW50ZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgZGlmZmljdWx0aWVzID0gbW9ja0dhbWVzLm1hcCgoZzogYW55KSA9PiBnLmRpZmZpY3VsdHkpO1xuICAgIGV4cGVjdChkaWZmaWN1bHRpZXMpLnRvQ29udGFpbignQmVnaW5uZXInKTtcbiAgICBleHBlY3QoZGlmZmljdWx0aWVzKS50b0NvbnRhaW4oJ0ludGVybWVkaWF0ZScpO1xuICAgIGV4cGVjdChkaWZmaWN1bHRpZXMpLnRvQ29udGFpbignQWR2YW5jZWQnKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ01vY2sgRGF0YSBSZWxhdGlvbnNoaXBzJywgKCkgPT4ge1xuICB0ZXN0KCdhbGwgc3R1ZGVudF9pZHMgaW4gZ2FtZXMgc2hvdWxkIGV4aXN0IGluIHN0dWRlbnRzJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0dWRlbnRJZHMgPSBtb2NrU3R1ZGVudHMubWFwKChzOiBhbnkpID0+IHMuc3R1ZGVudF9pZCk7XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHN0dWRlbnRJZHMpLnRvQ29udGFpbihnYW1lLnN0dWRlbnRfaWQpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdhbGwgdGVhY2hlcl9pZHMgaW4gc3R1ZGVudHMgc2hvdWxkIGV4aXN0IGluIHRlYWNoZXJzJywgKCkgPT4ge1xuICAgIGNvbnN0IHRlYWNoZXJJZHMgPSBtb2NrVGVhY2hlcnMubWFwKCh0OiBhbnkpID0+IHQudGVhY2hlcl9pZCk7XG4gICAgbW9ja1N0dWRlbnRzLmZvckVhY2goKHN0dWRlbnQ6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHRlYWNoZXJJZHMpLnRvQ29udGFpbihzdHVkZW50LnRlYWNoZXJfaWQpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdhbGwgdGVhY2hlcl9pZHMgaW4gZ2FtZXMgc2hvdWxkIGV4aXN0IGluIHRlYWNoZXJzJywgKCkgPT4ge1xuICAgIGNvbnN0IHRlYWNoZXJJZHMgPSBtb2NrVGVhY2hlcnMubWFwKCh0OiBhbnkpID0+IHQudGVhY2hlcl9pZCk7XG4gICAgbW9ja0dhbWVzLmZvckVhY2goKGdhbWU6IGFueSkgPT4ge1xuICAgICAgZXhwZWN0KHRlYWNoZXJJZHMpLnRvQ29udGFpbihnYW1lLnRlYWNoZXJfaWQpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdlYWNoIHN0dWRlbnQgc2hvdWxkIGhhdmUgYXQgbGVhc3Qgb25lIGdhbWUnLCAoKSA9PiB7XG4gICAgbW9ja1N0dWRlbnRzLmZvckVhY2goKHN0dWRlbnQ6IGFueSkgPT4ge1xuICAgICAgY29uc3Qgc3R1ZGVudEdhbWVzID0gbW9ja0dhbWVzLmZpbHRlcigoZzogYW55KSA9PiBnLnN0dWRlbnRfaWQgPT09IHN0dWRlbnQuc3R1ZGVudF9pZCk7XG4gICAgICBleHBlY3Qoc3R1ZGVudEdhbWVzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19